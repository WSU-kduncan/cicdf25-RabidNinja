#!/usr/bin/env bash
set -euo pipefail

# ----- CONFIG -----
IMAGE="lordrabid/cs3120proj4:latest"
CONTAINER_NAME="proj4container"
HOST_PORT="80"
CONTAINER_PORT="80"
# -------------------

# Stop and remove existing container if it exists
if docker ps -a --format '{{.Names}}' | grep -q "^${CONTAINER_NAME}$"; then
  docker stop "${CONTAINER_NAME}" || true
  docker rm "${CONTAINER_NAME}" || true
fi

# Pull latest image
docker pull "${IMAGE}"

# Run new container
docker run -d \
  --name "${CONTAINER_NAME}" \
  --restart=always \
  -p "${HOST_PORT}:${CONTAINER_PORT}" \
  "${IMAGE}"